# Transform in GJF

Continuing to a higher level of optimization based on the optimized structure is a very common step in quantum chemistry computational workflows. MolOP provides some simple interfaces to simplify the manpower required for this step.

An GJF file example


```python
%nprocshared=32
%mem=60GB
# opt=(modredundant,maxcycle=150) freq b3lyp/genecp
empiricaldispersion=gd3bj

Title Card Required

0 3
C      0.000000    0.000000    0.000000
C      2.307938    0.000000    0.000000
C      0.551281    1.455665    0.000000
H     -0.534948   -0.259711    0.912472
H      0.285704    2.016486   -0.895964
H      0.278983    2.038113    0.877842
H     -0.583783   -0.246039   -0.885189
N      2.047530    1.259741    0.008719
O      1.243330   -0.862692   -0.039545
C      6.760990    0.754338    1.457474
C      4.696381    0.278635    0.542206
C      5.943716    2.058450    1.244045
H      7.640334    0.698190    0.816078
H      5.677849    2.549412    2.181628
H      6.448703    2.757574    0.572429
H      7.014602    0.553909    2.496806
N      4.665040    1.565793    0.595429
O      5.823460   -0.343458    1.010135
C      3.669713   -0.627992   -0.076903
Cu     3.328877    2.665479   -0.156937
C      3.669647   -2.004753    0.618788
H      3.418008   -1.901497    1.677888
H      2.927090   -2.643755    0.139759
H      4.662067   -2.447796    0.532686
C      4.032693   -0.776346   -1.592101
H      5.011220   -1.257391   -1.673191
H      3.276414   -1.398086   -2.078448
H      4.072352    0.208312   -2.067119
Cl     1.984177    4.360351    0.662558
C      4.248440    3.374850   -1.648000
C      3.512436    4.138486   -2.590439
C      5.351886    2.615216   -2.213984
C      3.833929    4.212685   -3.960867
H      2.670980    4.722276   -2.226903
C      5.679945    2.648866   -3.535885
H      5.948133    2.004560   -1.548212
C      3.087301    5.007282   -4.877240
C      4.943160    3.452355   -4.465498
H      6.505340    2.052703   -3.915505
C      3.420661    5.047067   -6.214080
H      2.252792    5.586396   -4.497123
C      5.259272    3.513231   -5.837046
C      4.514823    4.296129   -6.703083
H      2.845527    5.659514   -6.898918
H      6.102062    2.937454   -6.205614
H      4.768346    4.338520   -7.755516
C      5.060314    4.865996   -0.477921
C      5.240120    5.316797    0.956396
C      3.920694    5.650205   -1.060827
H      6.085619    6.027416    1.054496
H      4.342828    5.850493    1.313600
H      5.417306    4.417944    1.564324
H      4.093230    6.744897   -1.056296
H      3.054893    5.495011   -0.349155
H      3.596217    5.319376   -2.048973
N      6.305899    4.994915   -1.164331
C      6.919490    6.261898   -0.982562
C      7.155876    3.867002   -1.123161
H      7.978195    6.257478   -0.730739
H      6.374238    6.806878   -0.168969
H      6.773673    6.850107   -1.931221
H      7.117626    3.362632   -2.124633
H      8.219510    4.067568   -0.925336
H      6.786111    3.155320   -0.341766

B 31 39 F

-H -Li -Na -K -Mg -B -Al -C -Si -N -P -O -S -F -Cl 0
6-31G*
****
-Cs -Fe -Co -Ni -Cu -Ag -Au -Pd -Ru -Rh -Os -Ir -Pt -Br -I 0
lanl2dz
****

-Cs -Fe -Co -Ni -Cu -Ag -Au -Pd -Ru -Rh -Os -Ir -Pt -Br -I 0
lanl2dz
```

The structure of GJF is:

- prefix (calculation parameters)
- title
- charge and multiplicity
- atoms and coords
- suffix (basis sets or more)

Load some files


```python
from molop import AutoParser
from rdkit.Chem import Draw
from rdkit.Chem.Draw import IPythonConsole  # for better drawing

IPythonConsole.drawOptions.addAtomIndices = True
IPythonConsole.molSize = 400, 400

files = AutoParser("../tests/test_files/g16log/*.log")
```

    MolOP parsing with 28 jobs: 100%|██████████| 39/39 [00:03<00:00, 10.48it/s]
    0 files failed to parse, 39 successfully parsed



```python
files[0][-1].rdmol
```




    
![png](transform_in_gjf_files/transform_in_gjf_6_0.png)
    



MolOP offers some functions to transform the molecule into customized gjf file.


```python
print(
    files[0][0].to_GJF_block(
        # If specified, will be used to overwrite the charge in the gjf file
        charge=None,
        # If specified, will be used to overwrite the multiplicity in the gjf file
        multiplicity=None,
        # path to read a gjf file as a template
        template=None,
        # prefix to add to the beginning of the gjf file, priority is lower than template
        prefix="# g16 gjf",
        # suffix to add to the end of the gjf file, priority is lower than template
        suffix="some basis",
    )
)
```

    # g16 gjf
    
     Title: Generated by MolOP
    
    0 1
    C            1.09427  -1.08201  -0.91848
    O            1.99309  -1.05417   0.20263
    C            2.68129   0.18986   0.09476
    C            1.59898   1.23878  -0.24650
    H            3.18842   0.37310   1.04557
    H            3.43808   0.12148  -0.70244
    H            2.02050   1.97697  -0.93812
    C            0.54663   0.37827  -1.03134
    C           -0.95730   0.24416  -0.58998
    H           -1.49702   0.03976  -1.52515
    C           -1.01997  -1.07650   0.23400
    O           -0.49215  -0.88839   1.55271
    H            0.47883  -0.93788   1.47054
    C           -1.65586   1.39579   0.07093
    H           -1.53635   1.46912   1.14811
    C            1.14191   1.99170   1.00719
    H            2.00442   2.48839   1.46789
    H            0.70120   1.31410   1.74327
    H            1.65219  -1.39653  -1.81173
    C           -2.43511  -1.60811   0.40228
    H           -2.41752  -2.56418   0.93474
    H           -3.03512  -0.90258   0.98552
    H           -2.91967  -1.75112  -0.56964
    C           -0.08611  -1.98673  -0.58152
    H           -0.58293  -2.30956  -1.50380
    H            0.22243  -2.87830  -0.02692
    H            0.40280   2.75868   0.76684
    C           -2.43377   2.27068  -0.56893
    H           -2.59135   2.21804  -1.64485
    H           -2.94080   3.07596  -0.04412
    H            0.55456   0.70973  -2.07286
    
    some basis
    
    


Use template


```python
print(
    files[0][0].to_GJF_block(
        # If specified, will be used to overwrite the charge in the gjf file
        charge=1,
        # If specified, will be used to overwrite the multiplicity in the gjf file
        multiplicity=3,
        # path to read a gjf file as a template
        template="../tests/test_files/g16gjf/test.gjf",
        # prefix to add to the beginning of the gjf file, priority is lower than template
        prefix="# g16 gjf",
        # suffix to add to the end of the gjf file, priority is lower than template
        suffix="some basis",
    )
)
```

    %nprocshared=32
    %mem=60GB
    # opt=(modredundant,maxcycle=150) freq b3lyp/genecp
    empiricaldispersion=gd3bj
    
     Title: Generated by MolOP
    
    1 3
    C            1.09427  -1.08201  -0.91848
    O            1.99309  -1.05417   0.20263
    C            2.68129   0.18986   0.09476
    C            1.59898   1.23878  -0.24650
    H            3.18842   0.37310   1.04557
    H            3.43808   0.12148  -0.70244
    H            2.02050   1.97697  -0.93812
    C            0.54663   0.37827  -1.03134
    C           -0.95730   0.24416  -0.58998
    H           -1.49702   0.03976  -1.52515
    C           -1.01997  -1.07650   0.23400
    O           -0.49215  -0.88839   1.55271
    H            0.47883  -0.93788   1.47054
    C           -1.65586   1.39579   0.07093
    H           -1.53635   1.46912   1.14811
    C            1.14191   1.99170   1.00719
    H            2.00442   2.48839   1.46789
    H            0.70120   1.31410   1.74327
    H            1.65219  -1.39653  -1.81173
    C           -2.43511  -1.60811   0.40228
    H           -2.41752  -2.56418   0.93474
    H           -3.03512  -0.90258   0.98552
    H           -2.91967  -1.75112  -0.56964
    C           -0.08611  -1.98673  -0.58152
    H           -0.58293  -2.30956  -1.50380
    H            0.22243  -2.87830  -0.02692
    H            0.40280   2.75868   0.76684
    C           -2.43377   2.27068  -0.56893
    H           -2.59135   2.21804  -1.64485
    H           -2.94080   3.07596  -0.04412
    H            0.55456   0.70973  -2.07286
    
    
    B 31 39 F
    
    -H -Li -Na -K -Mg -B -Al -C -Si -N -P -O -S -F -Cl 0
    6-31G*
    ****
    -Cs -Fe -Co -Ni -Cu -Ag -Au -Pd -Ru -Rh -Os -Ir -Pt -Br -I 0
    lanl2dz
    ****
    
    -Cs -Fe -Co -Ni -Cu -Ag -Au -Pd -Ru -Rh -Os -Ir -Pt -Br -I 0
    lanl2dz
    
    


For file level, MolOP offers the similar functions


```python
print(
    files[0].to_GJF_block(
        # If specified, will be used to overwrite the charge in the gjf file
        charge=1,
        # If specified, will be used to overwrite the multiplicity in the gjf file
        multiplicity=3,
        # path to read a gjf file as a template
        template="../tests/test_files/g16gjf/test.gjf",
        # prefix to add to the beginning of the gjf file, priority is lower than template
        prefix="# g16 gjf",
        # suffix to add to the end of the gjf file, priority is lower than template
        suffix="some basis",
        # If specified, will use the frameID to get the coords, default is -1
        frameID=-1,
    )
)
```

    %nprocshared=32
    %mem=60GB
    # opt=(modredundant,maxcycle=150) freq b3lyp/genecp
    empiricaldispersion=gd3bj
    
     Title: Generated by MolOP
    
    1 3
    C            1.09649  -1.06694  -0.90868
    O            1.99547  -1.03122   0.19983
    C            2.67091   0.20362   0.07741
    C            1.58246   1.23957  -0.23338
    H            3.21486   0.39356   1.01327
    H            3.41523   0.14250  -0.74122
    H            1.99380   1.99643  -0.92057
    C            0.54417   0.38155  -1.01823
    C           -0.94879   0.23805  -0.58403
    H           -1.48452   0.02399  -1.52694
    C           -1.00948  -1.07958   0.23342
    O           -0.49768  -0.89164   1.54763
    H            0.46934  -0.93730   1.48255
    C           -1.65975   1.37913   0.06526
    H           -1.56153   1.44246   1.15497
    C            1.12102   1.96367   1.02004
    H            1.97844   2.44769   1.51027
    H            0.66043   1.27862   1.74527
    H            1.65764  -1.37533  -1.81235
    C           -2.41476  -1.61334   0.38719
    H           -2.40367  -2.57881   0.91033
    H           -3.02286  -0.91936   0.98384
    H           -2.90621  -1.74577  -0.58653
    C           -0.07008  -1.97219  -0.57878
    H           -0.56702  -2.29780  -1.50545
    H            0.24321  -2.87440  -0.03371
    H            0.39072   2.75096   0.79701
    C           -2.42849   2.26412  -0.57392
    H           -2.56876   2.22677  -1.65956
    H           -2.94788   3.06560  -0.04339
    H            0.55423   0.71705  -2.06521
    
    
    B 31 39 F
    
    -H -Li -Na -K -Mg -B -Al -C -Si -N -P -O -S -F -Cl 0
    6-31G*
    ****
    -Cs -Fe -Co -Ni -Cu -Ag -Au -Pd -Ru -Rh -Os -Ir -Pt -Br -I 0
    lanl2dz
    ****
    
    -Cs -Fe -Co -Ni -Cu -Ag -Au -Pd -Ru -Rh -Os -Ir -Pt -Br -I 0
    lanl2dz
    
    


Functions above both have to-file vesion.


```python
files[0][0].to_GJF_file(
    # If not specified, will be generated in situ
    file_path="../tests/test_files/temp/test.gjf",
    # If specified, will be used to overwrite the charge in the gjf file
    charge=1,
    # If specified, will be used to overwrite the multiplicity in the gjf file
    multiplicity=3,
    # path to read a gjf file as a template
    template="../tests/test_files/g16gjf/test.gjf",
    # prefix to add to the beginning of the gjf file, priority is lower than template
    prefix="# g16 gjf",
    # suffix to add to the end of the gjf file, priority is lower than template
    suffix="some basis",
)
# return the file path saved to
```




    '/home/tmj/proj/MolOP/tests/test_files/temp/test.gjf'




```python
files[0].to_GJF_file(
    # If not specified, will be generated in situ
    file_path="../tests/test_files/temp/test.gjf",
    # If specified, will be used to overwrite the charge in the gjf file
    charge=1,
    # If specified, will be used to overwrite the multiplicity in the gjf file
    multiplicity=3,
    # path to read a gjf file as a template
    template="../tests/test_files/g16gjf/test.gjf",
    # prefix to add to the beginning of the gjf file, priority is lower than template
    prefix="# g16 gjf",
    # suffix to add to the end of the gjf file, priority is lower than template
    suffix="some basis",
    # If specified, will use the frameID to get the coords, default is -1
    frameID=-1,
)
# return the file path saved to
```




    '/home/tmj/proj/MolOP/tests/test_files/temp/test.gjf'



FileBatch level offers a function to transform in batch


```python
files.to_GJF_file(
    # If not specified, will be generated the work directory
    file_path="../tests/test_files/temp",
    # If specified, will be used to overwrite the charge in the gjf file
    charge=1,
    # If specified, will be used to overwrite the multiplicity in the gjf file
    multiplicity=3,
    # path to read a gjf file as a template
    template="../tests/test_files/g16gjf/test.gjf",
    # prefix to add to the beginning of the gjf file, priority is lower than template
    prefix="# g16 gjf",
    # suffix to add to the end of the gjf file, priority is lower than template
    suffix="some basis",
    # If specified, will use the frameID to get the coords, default is -1
    frameID=-1,
)
```

    gjf files saved to /home/tmj/proj/MolOP/tests/test_files/temp



```python

```
